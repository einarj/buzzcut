<%- model_class = Feed -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human %></h1>
</div>

<h1>Twitter auth:</h1>
<a href="/auth/twitter/?use_authorize=true">LOGIN</a>

<%= link_to 'Update tweets', update_all_tweets_path, :method => :put, :remote => true %>

<h2>Tweets from Angular and Rails</h2>
    <!-- Based on 
      http://stackoverflow.com/questions/14692640/angularjs-directive-to-replace-text and
      http://jsfiddle.net/bmleite/FyGen/
    -->
<%= javascript_tag do %>
  function TweetsCtrl($scope) {
    $scope.tweets = <%= raw @tweets.to_json %>

    $scope.props = {
        target: '_blank',
        otherProp: 'otherProperty'
    };

    $scope.formatText = function(text) {
      return twttr.txt.autoLink(text);
    }
  };
<% end %>
<div ng-controller="TweetsCtrl">
  <ul class="media-list">
    <li class="media">
      <div class="pull-left">100</div>
      <div class="media-body">
        <h4 class="media-heading">
          <a href="http://www.rubylang.org">The Ruby Programming Language</a>
        </h4>
        <!-- For each mention, show the tweet -->
        <div class="media" ng-repeat="tweet in tweets">
          <div class="pull-left">
            <img class="avatar size32" ng-src="{{tweet.user.profile_image_url}}" alt="{{tweet.user.name}}"> 
          </div>
          <div class="media-body">
            <p ng-bind-html-unsafe="formatText(tweet.text)"></p>
          </div>
        </div>
      </div>
    </li>
<!--
    <li class="media">
      <div class="pull-left">13</div>
      <div class="media-body">
        <h4 class="media-heading">
          <a href="http://www.rubyonrails.org">Ruby On Rails</a>
        </h4>
-->
<!-- For each mention, show the tweet -->
<!--
        <div class="media" ng-repeat="tweet in tweets">
          <div class="pull-left">
            <img class="avatar size32" ng-src="{{tweet.user.profile_image_url}}" alt="{{tweet.user.name}}"> 
          </div>
          <div class="media-body">{{tweet.text}}</div>
        </div>
      </div>
      </li>
      -->
  </ul>
</div>

